@model List<UNO.AppModel.AcsControllerInfo>
@{
    ViewBag.Title = "Controller Status";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 18px;
        float: left; margin-right:5px;
    }

    input[type="radio"] {
        margin: 0px 2px 0;
        margin-top: 1px \9;
        line-height: normal;
        float: left;
    }

    .radio-inline, .checkbox-inline {
        position: relative;
        display: inline-block;
        padding-left: 10px;
        margin-bottom: 0;
        font-weight: normal;
        vertical-align: middle;
        cursor: pointer;
    }

    .switch input {
        display: none;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        -webkit-transition: .4s;
        transition: .4s;
    }

        .slider:before {
            position: absolute;
            content: "";
            height: 15px;
            width: 15px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

    input:checked + .slider {
        background-color: #2196F3;
    }

    input:focus + .slider {
        box-shadow: 0 0 1px #2196F3;
    }

    input:checked + .slider:before {
        -webkit-transform: translateX(26px);
        -ms-transform: translateX(26px);
        transform: translateX(26px);
    }
    .slider.round {
        border-radius: 34px;
        height: 22px;
    }
        .slider.round:before {
            border-radius: 50%;
        }

    .table-responsive {
        min-height: .01%;
        overflow-x: visible;
        margin-top: -30PX;
    }
</style>
<div class="container-fluid">
    <div class="spacer clearfix">
        <div class="row">
            <div class="col-md-12">
                <div class="blog blog-default ">
                    <div class="blog-header ">
                        <h4 class="blog-title pull-left mt5">Listing</h4>
                        <div class="dt-buttons pull-right">
                            <a class="btn btn-default" href="#"><span><i class="fa fa-print"></i> Print</span></a> <a class="btn btn-default" href="#"><span><i class="fa fa-file-excel-o"></i> Excel</span></a>
                        </div>
                        <span class="clearfix"></span>
                    </div>
                    <div class="blog-body">
                        <div class="table-responsive">
                            <div style="float: left; position: relative; top: 29px;">
                                <label class="switch">
                                    <input id="EnableSync" type="checkbox">
                                    <span class="slider round"></span>
                                </label>
                                <span style="text-decoration-color: blue;line-height: 25px;"> Refresh</span>
                            </div>
                            <div id="dt_example" class="table-responsive example_alt_pagination clearfix">
                                <table id="lsttable" class="table table-condensed table-striped table-hover table-bordered pull-left">
                                    <thead>
                                        <tr>
                                            <th style='display:none'></th>
                                            <th class="text-center">Controller ID</th>
                                            <th class="text-center">Controller Description</th>
                                            <th class="text-center">Controller Type</th>
                                            <th class="text-center">Controller IP</th>
                                            <th class="text-center">Firmware Version No</th>
                                            <th class="text-center">Communicate Time</th>
                                            <th class="text-center">Key Pad Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="data">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts
{
    <script type="text/javascript">
        var Timer;
        var DataList = 0;
        $(document).ready(function () {
            $("#btnCreateNew").hide();
            $('#lsttable').dataTable({
                "sPaginationType": "full_numbers",
                dom: 'lBfrtip',
                "bInfo": false,
                oLanguage: {
                    sLengthMenu: "Show: _MENU_",
                },
                "aoColumnDefs": [
              { "bSortable": false, "aTargets": [] }
                ],
                buttons: [
                    {
                        text: '<i class="fa fa-plus-circle"></i> Add New',
                        action: function myFunction() {
                            location.href = createNewPage;
                        },
                        attr: {
                            id: 'btnCreateNew'
                        }
                    }
                ]

            });
            $("#btnCreateNew").hide();
            $("[type=checkbox]").click(function () {
                
                if ($("#EnableSync").is(":checked") == true) {
                    Timer = setInterval(SyncEnabled, 10000);
                }
                else {
                    clearInterval(Timer);
                }
            });
            SyncEnabled();
            
        });
        function SyncEnabled() {
            $.ajax({
                   type: "GET",
                   url: '@Url.Action("GetList", "ControllerStatus")',
                success: function (data) {
                    DataList = $.parseJSON(data)
                       var str = "";
                       if (DataList != null) {
                           DataList.forEach(function (response) {
                               str += "<tr>" +
                               "<td style='display:none'>" + response.ID + "</td>" +
                               "<td>" + response.CTLR_ID + "</td>" +
                               "<td>" + response.CTLR_DESCRIPTION + "</td>" +
                               "<td>" + response.CTLR_TYPE + "</td>" +
                               "<td>" + response.CTLR_IP + "</td>" +
                               "<td>" + response.CTLR_FIRMWARE_VERSION_NO + "</td>" +
                               "<td>" + response.CTLR_CONN_STATUS + "</td>" +
                               "<td>" + response.CTLR_KEY_PAD + "</td>" +
                               "</tr>";
                           });
                       }
                       if ($.fn.dataTable.isDataTable('#lsttable')) {
                           var table = $('#lsttable').dataTable();

                           table.fnClearTable();
                           table.fnDestroy();
                           $("#data").html(str);

                           $("#lsttable").dataTable(
                               {
                                   "sPaginationType": "full_numbers",
                                   oLanguage: {
                                       sLengthMenu: "Show: _MENU_",
                                   },
                                   pageLength: 10,
                                   "aoColumns": [
                                               null,
                                               null,
                                               null,
                                               null,
                                               null,
                                               null,
                                               null,
                                               null
                                              
                                   ]
                               });
                       }
                       else {
                           var s = "";
                           $("#data").html(str);

                           $("#lsttable").dataTable(
                              {
                                  "sPaginationType": "full_numbers",
                                  oLanguage: {
                                      sLengthMenu: "Show: _MENU_",
                                  },
                                  pageLength: 10,
                                  "aoColumns": [
                                               null,
                                               null,
                                               null,
                                               null,
                                               null,
                                               null,
                                               null,
                                               null
                                              
                                  ]
                              });
                       }
                   },
                   error: function (reponse) {
                   }
               });
        }
    </script>
}